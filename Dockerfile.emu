FROM java

ARG GCLOUD_SDK_VERSION=183.0.0

RUN wget https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${GCLOUD_SDK_VERSION}-linux-x86_64.tar.gz \
 && tar xvf google-cloud-sdk-${GCLOUD_SDK_VERSION}-linux-x86_64.tar.gz \
 && rm google-cloud-sdk-${GCLOUD_SDK_VERSION}-linux-x86_64.tar.gz \
 && /google-cloud-sdk/install.sh --quiet

RUN /google-cloud-sdk/bin/gcloud --quiet components install beta pubsub-emulator

CMD ["/google-cloud-sdk/bin/gcloud", "beta", "emulators", "pubsub", "start", "--host-port", "0.0.0.0:8085"]
